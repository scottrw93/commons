type: procfile
buildName: git.hubteam.com-HubSpotProtected-Blazar-staging-BlazarExecutor
accessGroup: hs-paas-build-deploy

team: hs-paas-build-deploy

owners:
 - jgoodwin@hubspot.com

docker:
  blazar-executor-java:
    cmd: "/usr/bin/java8 -jar /mnt/mesos/sandbox/app/target/BlazarExecutor-1.0-staging-SNAPSHOT-shaded.jar --blazarApiDomain https://build.hubteamqa.com --ipTablesLockProd=true --ipTablesLockQa=true $EXTRA_EXECUTOR_ARGS"
    network: BRIDGE
    daemon: false
    image: docker.hubteam.com/hubspot/git.hubteam.com-hubspotprotected-wailmer-master-executor:latest
    addDefaultVolumes: false
    dockerParameters:
      privileged: true
      cap-add: NET_ADMIN
    volumes:
      - hostPath: /usr/share/hubspot/vault/hs-paas-build-deploy
        containerPath: /usr/share/hubspot/vault/hs-paas-build-deploy.real
        mode: RO
      - hostPath: /etc/hubspot.bootstrap.properties
        containerPath: /usr/share/hubspot/internal/hubspot.bootstrap.properties.real
        mode: RO
      - hostPath: /usr/share/hubspot/mesos/blazar_cache
        containerPath: /usr/share/hubspot/mesos/blazar_cache
        mode: RW
      - hostPath: '$PWD/app/build-workspace'
        containerPath: /usr/share/hubspot/build/workspace
        mode: RW
      - hostPath: /var/run/docker.sock
        containerPath: /var/run/host-docker.sock
        mode: RW
      - hostPath: '$PWD/var-lib-docker'
        containerPath: /var/lib/docker
        mode: RW
      - hostPath: '/usr/share/hubspot/mesos/blazar_cache/blazar-tmp'
        containerPath: '/mnt/mesos/tmp/'
        mode: RW

# makes the log stay as service.log 5ever
skipLogrotateAndCompress: true
env:
  all:
    HOST_PWD: "$PWD"
    CGROUP_PARENT: "mesos/$CGROUPS_GUID"
    HS_PAAS_BUILD_DEPLOY_VAULT_KEY: "$(cat /usr/share/hubspot/vault/hs-paas-build-deploy)"



servers:
  qa:
    - mesos:
        numCpus: 2
        memoryMb: 2560
        placement: GREEDY

  prod:
    - mesos:
        numCpus: 2
        memoryMb: 2560
        placement: GREEDY

emailSettings:
  DEPLOYABLE_INSTANCE_FINISHED: []
