type: acceptance_test

artifactBuildMetadata:
  organization: HubSpotProtected
  repository: Blazar
  module: BlazarExecutorAcceptanceTests

accessGroup: hs-paas-build-deploy
team: hs-paas-build-deploy

slack:
- channelName: "#paas-build-deploy-notifications"
  all:
    preDeploy: MUTE
    success: NOTIFY
    failure: NOTIFY
    notifyForBlockerEvents: NOTIFY
    deployedNotRun: MUTE
  qa:
    success: MUTE
    failure: MUTE
    notifyForBlockerEvents: MUTE


blazarConfiguration:
  signalFx:
    authToken: RCvMukb4vXpVhKo_kI0HrQ
    defaultDataSourceName: BlazarExecutorAcceptanceTests

zkGroup: BlazarAcceptanceTests
tests:
  test1:
    testType: USER_DEFINED
    image: docker.hubteam.com/hubspot/git.hubteam.com-hubspotprotected-wailmer-master-acceptancetests:412
    cmd: "/usr/bin/java8 -jar /mnt/mesos/sandbox/app/target/BlazarExecutorAcceptanceTests-executable.jar $CONFIG_YAML"
    schedule: 0/5 * * * *
    # network: BRIDGE
    dockerParameters:
      privileged: true
      cap-add: NET_ADMIN
    override:
      qa:
        allowSpotInstances: true
    #volumes:
    #  - hostPath: '$PWD/app/build-workspace'
    #    containerPath: /usr/share/hubspot/build/workspace
    #    mode: RW
    #  - hostPath: '/usr/share/hubspot/mesos/blazar_cache/blazar-tmp'
    #    containerPath: '/mnt/mesos/tmp/'
    #    mode: RW

env:
  all:
    HOST_PWD: "$PWD"
    CGROUP_PARENT: "mesos/$CGROUPS_GUID"
    HS_PAAS_BUILD_DEPLOY_VAULT_KEY: "$(cat /usr/share/hubspot/vault/hs-paas-build-deploy)"

servers:
  qa:
  - mesos
  prod:
  - mesos
