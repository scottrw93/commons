type: acceptance_test

artifactBuildMetadata:
  organization: HubSpotProtected
  repository: Blazar
  module: BlazarExecutorAcceptanceTests

accessGroup: hs-paas-build-deploy
team: hs-paas-build-deploy

slack:
  - channelName: "#paas-b-d-notifs"

owners:
 - paas-build-deploy-notifications-groups@hubspot.com
 
blazarConfiguration:
  signalFx:
    authToken: RCvMukb4vXpVhKo_kI0HrQ

zkGroup: BlazarAcceptanceTests
tests:
  test1:
    testType: USER_DEFINED
    image: docker.hubteam.com/hubspot/git.hubteam.com-hubspotprotected-wailmer-master-acceptancetests:209
    cmd: "/usr/bin/java8 -jar /mnt/mesos/sandbox/app/target/BlazarExecutorAcceptanceTests-executable.jar $CONFIG_YAML"
    schedule: 0/5 * * * *
    # network: BRIDGE
    # daemon: false
    dockerParameters:
      privileged: true
      cap-add: NET_ADMIN
    #volumes:
    #  - hostPath: '$PWD/app/build-workspace'
    #    containerPath: /usr/share/hubspot/build/workspace
    #    mode: RW
    #  - hostPath: '/usr/share/hubspot/mesos/blazar_cache/blazar-tmp'
    #    containerPath: '/mnt/mesos/tmp/'
    #    mode: RW

# makes the log stay as service.log 5ever
env:
  all:
    HOST_PWD: "$PWD"
    CGROUP_PARENT: "mesos/$CGROUPS_GUID"
    HS_PAAS_BUILD_DEPLOY_VAULT_KEY: "$(cat /usr/share/hubspot/vault/hs-paas-build-deploy)"
    # RO keys that let us find all the active Ip addresses
    AWS_ACCESS_KEY: AKIAJIXPLXGE7A6QBH6A
    AWS_SECRET_KEY: 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

servers:
  qa:
    - mesos
  prod:
    - mesos
