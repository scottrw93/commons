type: procfile

includeConfigs:
  - Orion-common

appRoot: /orion/v3

artifactBuildMetadata:
  repository: Orion
  module: OrionService

env:
  all:
    JAR_NAME: ./target/OrionService-executable.jar
    JVM_MAX_HEAP: 1024m
    MIGRATION_JOB_CLASS: com.hubspot.orion.OrionLiquibaseMigrationJob

zkGroup: mesos:deploy:v3

procfile:
  dbmigrate:
    type: ON_DEMAND
    cmd: java-wrapper -Djava.net.preferIPv4Stack=true -jar $JAR_NAME $MIGRATION_JOB_CLASS db migrate
  fast-forward:
    cmd: java-wrapper -Djava.net.preferIPv4Stack=true -jar $JAR_NAME $MIGRATION_JOB_CLASS db fast-forward --all
    type: ON_DEMAND
  dbstatus:
    type: ON_DEMAND
    cmd: java-wrapper -Djava.net.preferIPv4Stack=true -jar $JAR_NAME $MIGRATION_JOB_CLASS db status
  dry-run:
    type: ON_DEMAND
    cmd: java-wrapper -Djava.net.preferIPv4Stack=true -jar $JAR_NAME $MIGRATION_JOB_CLASS db migrate -n
