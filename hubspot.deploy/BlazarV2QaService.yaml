# HubSpot Deploy Settings
loadBalancers:
  - bootstrap
  - privateapi
  - privatehubteam

type: procfile
includeConfigs:
  - BlazarV2QaSettings

procfile:
  web:
    cmd: java-wrapper $EXTRA_ARGS -Ddw.server.connector.port=5757 -cp ./target/\* com.hubspot.blazar.BlazarService server $CONFIG_YAML
    type: SERVICE

  # Cleans archived repos
  cleanMetadataCommand:
    type: SCHEDULED_JOB
    cmd: java-wrapper $EXTRA_ARGS -cp ./target/\* com.hubspot.blazar.BlazarService clean_repo_metadata $CONFIG_YAML
    schedule: "0 2 * * *"

  migrationStatus:
    type: ON_DEMAND
    cmd: java-wrapper $EXTRA_ARGS -cp ./target/\* com.hubspot.blazar.BlazarService db status $CONFIG_YAML

  migrationRun:
    type: ON_DEMAND
    cmd: java-wrapper $EXTRA_ARGS -cp ./target/\* com.hubspot.blazar.BlazarService db migrate $CONFIG_YAML

servers:
  qa:
    - stale-goose
    - lucky-dingo
  prod: []

forcePorts: [5757]
